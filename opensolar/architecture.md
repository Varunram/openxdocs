# Architecture

### Introduction

Opensolar is a platform built on top of openx and the Stellar blockchain that enables investments in solar infrastructure. Opensolar's initial pilots are targeted at Puerto Rico, a territory that has been frequently subject to hurricanes, earthquakes and more, preventing access to energy for prolonged periods of time. Opensolar aims to automate the entire process of energy production, billing, and asset ownership for the recipient and the process of returns for the investor. This is done by monitoring energy production using IoT devices, storing the data on a distributed database, and paying for energy consumption over a pre-defined period \(two weeks / a month\) by fetchin g energy prices from an oracle. The entire workflow is implemented as a series of contracts designed to be run on the platform instance.

### Solar Infrastructure

Solar Infrastructure is composed of multiple parts - Solar Panels, IoT devices which report energy generated to an IoT Hub, and an IoT Hub which records the amount of energy generated during every interval of time defined. Opensolar interfaces with the IoT Hub to collect data on energy consumption and trigger the conditions defined by the smart contract. ****This is done by running an executable called the **Teller** on the IoT Hub.

**Teller**

The teller is an executable that interfaces with the opensolar platform to constantly report progress, stores energy data on the blockchain, and automatically triggers payments every payment interval. The teller contains information about the recipient so it can draw funds from the recipient's account for paying back towards the invesment contract. The teller also acts as a mini CLI emulator which can be used to query limited things like the amount of money left in the recipient's account and the latest state of the teller.

**MQTT Broker**

The IoT devices that are linked to the solar panels transmit data using the MQTT protocol. The MQTT protocol requires a transmitter \(in this case the IoT devices linked to the solar panel\), a broker to broadcast the messages received from the transmitter, and a receiver which can connect to the broker and subscribe to messages from the transmitter. The broker can either be run alongside the platform or can be run on the IoT Hub, depending on the energy specifications of the IoT Hub and its capabilities. Opensolar runs an MQTT broker at mqtt.openx.solar which acts as the broker for projects on the opensolar platform.

**Swytch.io**

Swytch.io is a third party provider which generates Renewable Energy Certificates \(RECs\) for each Megawatt of energy generated. A copy of the data sent to mqtt.openx.solar is also sent to Swytch.io to allow them to mint RECs. These RECs can be sold by the recipient or investor on secondary markets as defined in the investment contract. Swytch also provides an interactive dashboard where the recipient can visualize the amount of energy generated throughout the day and other statistics.

### Smart Contracts

Opensolar is powered by a collection of smart contracts. TODO

### KYC

AnchorUSD requires KYC to be done through its portal. TODO

### Investors

### Recipients

### Guarantors

### Contractors

### Originators

### Project Stages

The platform is comprised into 9 distinct stages:

TODO

### Investment Models

Opensolar aims to support multiple investment models during its development phase but right now, only one kind of investment \(munibond\) is supported on the platform.

### Platform Infrastructure

The opensolar platform and the openx instance associated with it are hosted on separate AWS instances. They communicate with each oteher through the platform-platform API defined by openx. The platform communicates with the broker, IPFS and other parts that are required in order for opensolar to work as expected.

### Stablecoin

Opensolar makes use of USDx, a digital representation of the US Dollar on Stellar provided by AnchorUSD. Procuring USDx requires one to undergo Know Your Customer \(KYC\) checks done by AnchorUSD. Once a user completes the checks required by AnchorUSD, they can invest in any project on the opensolar platform.

USDx can also be procured on the Stellar DEX and used to invest on the platform.

Recipients can purchase USDx through AnchorUSD's website, having gone through the same KYC processes subjected to an investor. Once a recipient loads funds into their account and given there is sufficient balance to pay towards the bills generated by the solar panels, the smart contract would trigger payments. If there is insufficient balance, the platform sends a reminder to the recipient to load funds into their account.

